<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>çˆ±çš„å¤©æ°”æé†’ - æ¯æ—¥ä¸ºTAé€ä¸Šæ¸©é¦¨å…³æ€€</title>
  <!-- Tailwind CSS v3 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  <!-- äºŒç»´ç ç”Ÿæˆåº“ -->
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <!-- å¾®ä¿¡JS-SDK -->
  <script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
  <!-- ç»Ÿä¸€çš„ Tailwind é…ç½® -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#ff6b8b',
            secondary: '#82c3ec',
            tertiary: '#ffd1da',
            dark: '#2c3e50',
            light: '#f8f9fa'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
          animation: {
            'float': 'float 3s ease-in-out infinite',
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'bounce-slow': 'bounce 3s infinite',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            }
          }
        }
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }
      .text-shadow-lg {
        text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.3);
      }
      .bg-blur {
        backdrop-filter: blur(8px);
      }
      .transition-all-300 {
        transition: all 0.3s ease;
      }
      .glass-effect {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
    }
  </style>
  <style>
    body {
      background: linear-gradient(135deg, #ff6b8b 0%, #82c3ec 50%, #ffd1da 100%);
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
    }
    
    .heart {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: #ff6b8b;
      transform: rotate(45deg);
      animation: float 3s ease-in-out infinite;
      opacity: 0.7;
    }
    
    .heart:before,
    .heart:after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: #ff6b8b;
      border-radius: 50%;
    }
    
    .heart:before {
      top: -10px;
      left: 0;
    }
    
    .heart:after {
      top: 0;
      left: -10px;
    }
    
    @keyframes float {
      0%, 100% {
        transform: translateY(0) rotate(45deg);
      }
      50% {
        transform: translateY(-10px) rotate(45deg);
      }
    }
    
    .weather-icon {
      width: 60px;
      height: 60px;
      object-fit: contain;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
      animation: fadeIn 0.5s ease-in-out;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .custom-scrollbar::-webkit-scrollbar {
      width: 6px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: rgba(255, 107, 139, 0.5);
      border-radius: 10px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 107, 139, 0.8);
    }
    
    .emotion-wave {
      position: relative;
      height: 20px;
      overflow: hidden;
    }
    
    .emotion-wave span {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #ff6b8b;
      border-radius: 50%;
      animation: wave 2s infinite ease-in-out;
      opacity: 0.7;
    }
    
    @keyframes wave {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }
    
    @keyframes pulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 107, 139, 0.7);
      }
      70% {
        transform: scale(1.02);
        box-shadow: 0 0 0 10px rgba(255, 107, 139, 0);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 107, 139, 0);
      }
    }
    
    /* å¼€å…³æ ·å¼ */
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
    }
    
    input:checked + .slider {
      background-color: #ff6b8b;
    }
    
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    
    .slider.round {
      border-radius: 24px;
    }
    
    .slider.round:before {
      border-radius: 50%;
    }
  </style>
</head>
<body class="font-sans text-dark">
  <!-- ç”Ÿæˆéšæœºæ¼‚æµ®çš„å¿ƒå½¢ -->
  <div id="hearts-container" class="fixed inset-0 pointer-events-none overflow-hidden"></div>
  
  <!-- å¯¼èˆªæ  -->
  <nav class="bg-white bg-opacity-80 backdrop-blur-md shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <i class="fa fa-heart text-primary text-2xl animate-pulse-slow"></i>
        <h1 class="text-xl md:text-2xl font-bold bg-gradient-to-r from-primary to-secondary text-transparent bg-clip-text">çˆ±çš„å¤©æ°”æé†’</h1>
      </div>
      <div class="hidden md:flex items-center space-x-6">
        <a href="#" class="nav-link active" data-tab="home">é¦–é¡µ</a>
        <a href="#" class="nav-link" data-tab="weather">å¤©æ°”æé†’</a>
        <a href="#" class="nav-link" data-tab="birthday">ç”Ÿæ—¥ç¥ç¦</a>
        <a href="#" class="nav-link" data-tab="emotion">æƒ…æ„ŸæŒ‡æ•°</a>
        <a href="#" class="nav-link" data-tab="settings">è®¾ç½®</a>
        <button id="view-visits" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium transition-all-300">
          <i class="fa fa-chart-bar mr-1"></i>è®¿é—®ç»Ÿè®¡
        </button>
      </div>
      <div class="md:hidden">
        <button id="mobile-menu-button" class="text-dark focus:outline-none">
          <i class="fa fa-bars text-xl"></i>
        </button>
      </div>
    </div>
    <!-- ç§»åŠ¨ç«¯èœå• -->
    <div id="mobile-menu" class="md:hidden hidden bg-white bg-opacity-95 backdrop-blur-md shadow-lg">
      <div class="container mx-auto px-4 py-2 flex flex-col space-y-3">
        <a href="#" class="nav-link active py-2" data-tab="home">é¦–é¡µ</a>
        <a href="#" class="nav-link py-2" data-tab="weather">å¤©æ°”æé†’</a>
        <a href="#" class="nav-link py-2" data-tab="birthday">ç”Ÿæ—¥ç¥ç¦</a>
        <a href="#" class="nav-link py-2" data-tab="emotion">æƒ…æ„ŸæŒ‡æ•°</a>
        <a href="#" class="nav-link py-2" data-tab="settings">è®¾ç½®</a>
        <button id="view-visits-mobile" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium transition-all-300 mx-4 mt-2">
          <i class="fa fa-chart-bar mr-1"></i>è®¿é—®ç»Ÿè®¡
        </button>
      </div>
    </div>
  </nav>
  
  <!-- ä¸»å†…å®¹åŒº -->
  <main class="container mx-auto px-4 py-8">
    <!-- é¦–é¡µ -->
    <section id="home" class="tab-content active">
      <div class="flex flex-col md:flex-row items-center justify-between gap-8 mb-12">
        <div class="md:w-1/2 text-center md:text-left">
          <h2 class="text-3xl md:text-5xl font-bold mb-4 text-shadow-lg">
            <span class="bg-gradient-to-r from-primary to-secondary text-transparent bg-clip-text">æ¯æ—¥</span>
            <span class="block mt-2">ä¸ºTAé€ä¸Š</span>
            <span class="block mt-2">æ¸©é¦¨å…³æ€€</span>
          </h2>
          <p class="text-lg md:text-xl mb-8 text-gray-700 max-w-lg mx-auto md:mx-0">
            è‡ªåŠ¨å‘é€å¤©æ°”æé†’å’Œç”Ÿæ—¥ç¥ç¦ï¼Œè®©çˆ±ä¸å†ç¼ºå¸­ï¼Œæ¯ä¸€å¤©éƒ½å……æ»¡æƒŠå–œä¸æ¸©æš–ã€‚
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
            <button id="btn-start" class="btn-primary bg-primary hover:bg-opacity-90 text-white font-bold py-3 px-6 rounded-full shadow-lg transform hover:scale-105 transition-all-300 flex items-center justify-center">
              <i class="fa fa-heart mr-2"></i> å¼€å§‹ä½¿ç”¨
            </button>
            <button id="btn-learn" class="btn-secondary bg-white hover:bg-gray-100 text-primary font-bold py-3 px-6 rounded-full shadow-lg transform hover:scale-105 transition-all-300 flex items-center justify-center border border-primary">
              <i class="fa fa-info-circle mr-2"></i> äº†è§£æ›´å¤š
            </button>
          </div>
        </div>
        <div class="md:w-1/2">
          <div class="rounded-2xl shadow-xl w-full max-w-md mx-auto animate-float bg-gradient-to-br from-primary to-secondary p-8 text-center">
              <i class="fa fa-heart text-white text-6xl mb-4"></i>
              <h3 class="text-white text-xl font-bold">çˆ±çš„å¤©æ°”æé†’</h3>
              <p class="text-white text-opacity-80 mt-2">æ¯æ—¥ä¸ºTAé€ä¸Šæ¸©é¦¨å…³æ€€</p>
            </div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16">
        <div class="bg-white bg-opacity-80 backdrop-blur-md rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all-300">
          <div class="w-16 h-16 bg-primary bg-opacity-20 rounded-full flex items-center justify-center mb-4 mx-auto">
            <i class="fa fa-cloud text-primary text-3xl"></i>
          </div>
          <h3 class="text-xl font-bold mb-3 text-center">å¤©æ°”è‡ªåŠ¨æé†’</h3>
          <p class="text-gray-700 text-center">
            è®¾ç½®åŸå¸‚å’Œæ—¶é—´ï¼Œæ¯å¤©è‡ªåŠ¨å‘TAçš„å¾®ä¿¡å‘é€å¤©æ°”æƒ…å†µå’Œæ¸©é¦¨æç¤ºï¼Œè®©TAæ„Ÿå—åˆ°ä½ çš„å…³å¿ƒã€‚
          </p>
        </div>
        
        <div class="bg-white bg-opacity-80 backdrop-blur-md rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all-300">
          <div class="w-16 h-16 bg-secondary bg-opacity-20 rounded-full flex items-center justify-center mb-4 mx-auto">
            <i class="fa fa-birthday-cake text-secondary text-3xl"></i>
          </div>
          <h3 class="text-xl font-bold mb-3 text-center">ç”Ÿæ—¥ç¥ç¦</h3>
          <p class="text-gray-700 text-center">
            è®°å½•åŒæ–¹ç”Ÿæ—¥ï¼Œç³»ç»Ÿä¼šåœ¨ç‰¹æ®Šæ—¥å­è‡ªåŠ¨å‘é€å®šåˆ¶åŒ–ç¥ç¦åˆ°TAçš„å¾®ä¿¡ï¼Œç»™TAä¸€ä¸ªæƒŠå–œã€‚
          </p>
        </div>
        
        <div class="bg-white bg-opacity-80 backdrop-blur-md rounded-xl shadow-lg p-6 transform hover:scale-105 transition-all-300">
          <div class="w-16 h-16 bg-tertiary bg-opacity-30 rounded-full flex items-center justify-center mb-4 mx-auto">
            <i class="fa fa-line-chart text-tertiary text-3xl"></i>
          </div>
          <h3 class="text-xl font-bold mb-3 text-center">æƒ…æ„ŸæŒ‡æ•°åˆ†æ</h3>
          <p class="text-gray-700 text-center">
            åˆ†æä½ ä»¬çš„äº’åŠ¨é¢‘ç‡å’Œå†…å®¹ï¼Œç”Ÿæˆæƒ…æ„Ÿè¿æ¥å¼ºåº¦æŠ¥å‘Šï¼Œå¸®åŠ©ä½ ä»¬æ›´å¥½åœ°ç»´æŠ¤å…³ç³»ã€‚
          </p>
        </div>
      </div>
      
      <div class="bg-white bg-opacity-80 backdrop-blur-md rounded-2xl shadow-xl p-8">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">å¦‚ä½•ä½¿ç”¨</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="flex flex-col items-center text-center">
            <div class="w-16 h-16 bg-primary bg-opacity-20 rounded-full flex items-center justify-center mb-4">
              <span class="text-primary font-bold text-xl">1</span>
            </div>
            <h3 class="text-xl font-bold mb-3">æ·»åŠ TAçš„ä¿¡æ¯</h3>
            <p class="text-gray-700">
              è¾“å…¥TAçš„å§“åã€å¾®ä¿¡å’Œç”Ÿæ—¥ä¿¡æ¯ï¼Œå»ºç«‹ä½ ä»¬çš„ä¸“å±è¿æ¥ã€‚
            </p>
          </div>
          
          <div class="flex flex-col items-center text-center">
            <div class="w-16 h-16 bg-primary bg-opacity-20 rounded-full flex items-center justify-center mb-4">
              <span class="text-primary font-bold text-xl">2</span>
            </div>
            <h3 class="text-xl font-bold mb-3">è®¾ç½®æé†’</h3>
            <p class="text-gray-700">
              é€‰æ‹©å¤©æ°”æé†’çš„åŸå¸‚å’Œæ—¶é—´ï¼Œä»¥åŠç”Ÿæ—¥ç¥ç¦çš„æ–¹å¼å’Œå†…å®¹ã€‚
            </p>
          </div>
          
          <div class="flex flex-col items-center text-center">
            <div class="w-16 h-16 bg-primary bg-opacity-20 rounded-full flex items-center justify-center mb-4">
              <span class="text-primary font-bold text-xl">3</span>
            </div>
            <h3 class="text-xl font-bold mb-3">äº«å—ç”œèœœäº’åŠ¨</h3>
            <p class="text-gray-700">
              ç³»ç»Ÿè‡ªåŠ¨å‘é€æé†’å’Œç¥ç¦ï¼Œè®©çˆ±æ— å¤„ä¸åœ¨ï¼Œæ¯ä¸€å¤©éƒ½å……æ»¡æƒŠå–œã€‚
            </p>
</div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- æƒ…æ„ŸæŒ‡æ•° -->
    <section id="emotion" class="tab-content">
      <div class="bg-white bg-opacity-80 backdrop-blur-md rounded-2xl shadow-xl p-8 mb-12">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">æƒ…æ„ŸæŒ‡æ•°</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <h3 class="text-xl font-bold mb-4">ä»Šæ—¥æƒ…æ„ŸçŠ¶æ€</h3>
            <div class="bg-gradient-to-br from-primary to-secondary rounded-xl p-6 text-white mb-6">
              <div class="flex items-center justify-between mb-4">
                <h4 class="text-lg font-bold">ç”œèœœæŒ‡æ•°</h4>
                <span class="text-3xl font-bold">85%</span>
              </div>
              <div class="w-full bg-white bg-opacity-30 rounded-full h-3 mb-4">
                <div class="bg-white h-3 rounded-full" style="width: 85%"></div>
              </div>
              <p class="text-sm opacity-90">ä»Šå¤©çš„äº’åŠ¨å¾ˆç”œèœœï¼Œç»§ç»­ä¿æŒå“¦ï¼</p>
            </div>
            
            <div class="space-y-4">
              <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <span class="flex items-center">
                  <i class="fa fa-heart text-primary mr-2"></i>
                  ä»Šæ—¥äº’åŠ¨æ¬¡æ•°
                </span>
                <span class="font-bold text-primary">12æ¬¡</span>
              </div>
              <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <span class="flex items-center">
                  <i class="fa fa-comment text-secondary mr-2"></i>
                  æ¶ˆæ¯å›å¤ç‡
                </span>
                <span class="font-bold text-secondary">98%</span>
              </div>
              <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <span class="flex items-center">
                  <i class="fa fa-birthday-cake text-tertiary mr-2"></i>
                  ç‰¹æ®Šæ—¥å­æé†’
                </span>
                <span class="font-bold text-green-500">å·²è®¾ç½®</span>
              </div>
            </div>
          </div>
          
          <div>
            <h3 class="text-xl font-bold mb-4">æƒ…æ„Ÿè¶‹åŠ¿å›¾</h3>
            <div class="bg-gray-50 rounded-xl p-4 mb-6">
              <canvas id="emotionChart" width="400" height="200"></canvas>
            </div>
            
            <h3 class="text-xl font-bold mb-4">æå‡å»ºè®®</h3>
            <div class="space-y-3">
              <div class="p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">
                <h4 class="font-bold text-yellow-800 mb-2">ğŸ’¡ å°è´´å£«</h4>
                <p class="text-yellow-700 text-sm">å¯ä»¥å¤šå‘ä¸€äº›å…³å¿ƒçš„æ¶ˆæ¯ï¼Œè®©å¯¹æ–¹æ„Ÿå—åˆ°ä½ çš„åœ¨ä¹</p>
              </div>
              <div class="p-4 bg-blue-50 border-l-4 border-blue-400 rounded">
                <h4 class="font-bold text-blue-800 mb-2">ğŸ¯ ä»Šæ—¥ç›®æ ‡</h4>
                <p class="text-blue-700 text-sm">å‘é€ä¸€æ¡æ¸©æš–çš„æ—©å®‰/æ™šå®‰æ¶ˆæ¯</p>
              </div>
              <div class="p-4 bg-green-50 border-l-4 border-green-400 rounded">
                <h4 class="font-bold text-green-800 mb-2">ğŸ‰ æˆå°±è§£é”</h4>
                <p class="text-green-700 text-sm">è¿ç»­7å¤©å‘é€å¤©æ°”æé†’ï¼Œè·å¾—"è´´å¿ƒå®ˆæŠ¤è€…"ç§°å·</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- è®¾ç½® -->
    <section id="settings" class="tab-content">
      <div class="bg-white bg-opacity-80 backdrop-blur-md rounded-2xl shadow-xl p-8 mb-12">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">è®¾ç½®</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <h3 class="text-xl font-bold mb-4">å¯¹æ–¹ä¿¡æ¯è®¾ç½®</h3>
            <div class="space-y-4">
              <div>
                <label for="partner-name" class="block text-gray-700 mb-2">å¯¹æ–¹æ˜µç§°</label>
                <input type="text" id="partner-name" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="è¾“å…¥å¯¹æ–¹çš„æ˜µç§°">
              </div>
              
              <div>
                <label for="partner-birthday" class="block text-gray-700 mb-2">å¯¹æ–¹ç”Ÿæ—¥</label>
                <input type="date" id="partner-birthday" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
              </div>
              
              <div>
                <label for="relationship-date" class="block text-gray-700 mb-2">çºªå¿µæ—¥</label>
                <input type="date" id="relationship-date" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
              </div>
              
              <div>
                <label for="partner-phone" class="block text-gray-700 mb-2">å¯¹æ–¹æ‰‹æœºå·</label>
                <input type="tel" id="partner-phone" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="è¾“å…¥å¯¹æ–¹æ‰‹æœºå·">
              </div>
              
              <div>
                <label for="partner-email" class="block text-gray-700 mb-2">å¯¹æ–¹é‚®ç®±</label>
                <input type="email" id="partner-email" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="è¾“å…¥å¯¹æ–¹é‚®ç®±">
              </div>
            </div>
          </div>
          
          <div>
            <h3 class="text-xl font-bold mb-4">æé†’è®¾ç½®</h3>
            <div class="space-y-4">
              <div class="flex items-center justify-between">
                <span>å¼€å¯å¤©æ°”æé†’</span>
                <label class="switch">
                  <input type="checkbox" id="weather-notify" checked>
                  <span class="slider round"></span>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <span>å¼€å¯ç”Ÿæ—¥æé†’</span>
                <label class="switch">
                  <input type="checkbox" id="birthday-notify" checked>
                  <span class="slider round"></span>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <span>å¼€å¯çºªå¿µæ—¥æé†’</span>
                <label class="switch">
                  <input type="checkbox" id="anniversary-notify" checked>
                  <span class="slider round"></span>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <span>å¼€å¯æƒ…æ„ŸæŒ‡æ•°</span>
                <label class="switch">
                  <input type="checkbox" id="emotion-track" checked>
                  <span class="slider round"></span>
                </label>
              </div>
            </div>
            
            <div class="mt-6">
              <h4 class="font-bold mb-2">æé†’æ—¶é—´è®¾ç½®</h4>
              <div class="space-y-3">
                <div>
                  <label class="block text-gray-700 mb-1">æ—©å®‰æé†’</label>
                  <input type="time" id="morning-time" value="07:30" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                <div>
                  <label class="block text-gray-700 mb-1">æ™šå®‰æé†’</label>
                  <input type="time" id="evening-time" value="21:30" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="mt-8 flex justify-center space-x-4">
          <button id="save-settings" class="bg-primary hover:bg-opacity-90 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all-300">
            ä¿å­˜è®¾ç½®
          </button>
          <button id="reset-settings" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all-300">
            é‡ç½®è®¾ç½®
          </button>
        </div>
        
        <div class="mt-6 text-center">
          <button id="share-wechat" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all-300">
            <i class="fa fa-wechat mr-2"></i>åˆ†äº«åˆ°å¾®ä¿¡
          </button>
        </div>
      </div>
    </section>
  </div>
  
  <script>
    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    document.addEventListener('DOMContentLoaded', function() {
      // ç”Ÿæˆéšæœºå¿ƒå½¢
      function createHeart() {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.style.left = Math.random() * 100 + '%';
        heart.style.top = Math.random() * 100 + '%';
        heart.style.animationDelay = Math.random() * 3 + 's';
        document.getElementById('hearts-container').appendChild(heart);
        
        setTimeout(() => {
          heart.remove();
        }, 3000);
      }
      
      // æ¯2ç§’ç”Ÿæˆä¸€ä¸ªæ–°å¿ƒå½¢
      setInterval(createHeart, 2000);
      
      // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
      const navLinks = document.querySelectorAll('.nav-link');
      const tabContents = document.querySelectorAll('.tab-content');
      
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          // ç§»é™¤æ‰€æœ‰æ´»è·ƒçŠ¶æ€
          navLinks.forEach(l => l.classList.remove('active'));
          tabContents.forEach(tab => tab.classList.remove('active'));
          
          // æ·»åŠ æ´»è·ƒçŠ¶æ€åˆ°å½“å‰ç‚¹å‡»çš„é“¾æ¥
          this.classList.add('active');
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
        });
      });
      
      // ä¿å­˜è®¾ç½®åŠŸèƒ½ - ç§»é™¤é‡å¤ç»‘å®š
      // è¿™äº›åŠŸèƒ½å·²ç»åœ¨åé¢å®šä¹‰ï¼Œé¿å…é‡å¤ç»‘å®š
      // ä¿å­˜å¤©æ°”æé†’è®¾ç½®
      // document.getElementById('save-weather-settings').addEventListener('click', saveWeatherSettings);
      // ä¿å­˜ç”Ÿæ—¥ç¥ç¦è®¾ç½®  
      // document.getElementById('save-birthday-settings').addEventListener('click', saveBirthdaySettings);
      
      // æ·»åŠ è”ç³»äººæŒ‰é’®
      document.getElementById('add-contact')?.addEventListener('click', function() {
        const contactName = prompt('è¯·è¾“å…¥è”ç³»äººå§“åï¼š');
        if (contactName && contactName.trim()) {
          const contactItem = document.createElement('div');
          contactItem.className = 'contact-item flex items-center bg-gray-100 px-4 py-2 rounded-full cursor-pointer';
          contactItem.innerHTML = `
            <input type="checkbox" class="mr-2" checked>
            <label>${contactName.trim()}</label>
          `;
          
          const addButton = document.getElementById('add-contact');
          addButton.parentNode.insertBefore(contactItem, addButton);
        }
      });
      
      // æœç´¢åŸå¸‚æŒ‰é’®
      document.getElementById('search-city')?.addEventListener('click', function() {
        const cityInput = document.getElementById('city');
        const city = cityInput.value.trim();
        if (city) {
          alert(`æ­£åœ¨æœç´¢ "${city}" çš„å¤©æ°”ä¿¡æ¯...`);
          // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„å¤©æ°”æœç´¢é€»è¾‘
        } else {
          alert('è¯·å…ˆè¾“å…¥åŸå¸‚åç§°');
        }
      });
      
      // ===== å¾®ä¿¡åˆ†äº«åŠŸèƒ½æ•´åˆ =====
      
      // æ–¹æ¡ˆ1: Web Share APIï¼ˆç§»åŠ¨ç«¯åŸç”Ÿåˆ†äº«ï¼‰
      function shareViaWebAPI(message) {
        if (navigator.share) {
          navigator.share({
            title: 'çˆ±çš„å¤©æ°”æé†’',
            text: message,
            url: window.location.href
          }).then(() => {
            console.log('Web Share API åˆ†äº«æˆåŠŸ');
          }).catch((error) => {
            console.log('Web Share API åˆ†äº«å¤±è´¥:', error);
            return false; // è¿”å›falseè¡¨ç¤ºéœ€è¦é™çº§å¤„ç†
          });
          return true; // è¿”å›trueè¡¨ç¤ºåˆ†äº«æˆåŠŸ
        }
        return false; // ä¸æ”¯æŒWeb Share API
      }
      
      // æ–¹æ¡ˆ2: å¤åˆ¶åˆ°å‰ªè´´æ¿åˆ†äº«
      function shareViaClipboard(message) {
        if (navigator.clipboard) {
          navigator.clipboard.writeText(message).then(() => {
            alert('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ä»¥ç²˜è´´åˆ°å¾®ä¿¡å‘é€ç»™å¯¹æ–¹ï¼');
          }).catch(() => {
            // é™çº§åˆ°ä¼ ç»Ÿæ–¹æ³•
            fallbackToManualCopy(message);
          });
        } else {
          fallbackToManualCopy(message);
        }
      }
      
      // é™çº§æ–¹æ¡ˆï¼šæ‰‹åŠ¨å¤åˆ¶
      function fallbackToManualCopy(message) {
        const textArea = document.createElement('textarea');
        textArea.value = message;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          alert('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ä»¥ç²˜è´´åˆ°å¾®ä¿¡å‘é€ç»™å¯¹æ–¹ï¼');
        } catch (err) {
          alert('è¯·æ‰‹åŠ¨å¤åˆ¶ä»¥ä¸‹å†…å®¹å‘é€ç»™å¯¹æ–¹ï¼š\n\n' + message);
        }
        
        document.body.removeChild(textArea);
      }
      
      // ç»Ÿä¸€çš„å¾®ä¿¡åˆ†äº«å…¥å£
      function shareToWeChat(message) {
        // ä¼˜å…ˆä½¿ç”¨Web Share API
        if (!shareViaWebAPI(message)) {
          // é™çº§ä½¿ç”¨å‰ªè´´æ¿
          shareViaClipboard(message);
        }
      }
      
      // ç”ŸæˆäºŒç»´ç åˆ†äº«
      function generateQRCode(elementId, text) {
        const qrContainer = document.getElementById(elementId);
        if (!qrContainer) return;
        
        qrContainer.innerHTML = ''; // æ¸…ç©ºä¹‹å‰çš„äºŒç»´ç 
        
        try {
          new QRCode(qrContainer, {
            text: text,
            width: 150,
            height: 150,
            colorDark: '#ff6b8b',
            colorLight: '#ffffff',
            correctLevel: QRCode.CorrectLevel.H
          });
          
          // æ˜¾ç¤ºäºŒç»´ç å®¹å™¨
          const qrWrapper = qrContainer.parentElement;
          if (qrWrapper) {
            qrWrapper.classList.remove('hidden');
          }
        } catch (error) {
          console.error('äºŒç»´ç ç”Ÿæˆå¤±è´¥:', error);
          qrContainer.innerHTML = '<p class="text-red-500 text-sm">äºŒç»´ç ç”Ÿæˆå¤±è´¥</p>';
        }
      }
      
      // å¤©æ°”æé†’ç”ŸæˆäºŒç»´ç 
      document.getElementById('generate-qr-weather')?.addEventListener('click', function() {
        const city = document.getElementById('city').value || 'åŒ—äº¬';
        const partnerName = document.getElementById('partner-name').value || 'äº²çˆ±çš„';
        const weatherInfo = `${city}ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦é€‚å®œï¼Œæ˜¯ä¸ªçº¦ä¼šçš„å¥½æ—¥å­å“¦~`;
        const message = `äº²çˆ±çš„${partnerName}ï¼Œ${weatherInfo} è®°å¾—æ³¨æ„ä¿æš–ï¼Œä¿æŒå¥½å¿ƒæƒ…ï¼â¤ï¸`;
        
        generateQRCode('weather-qr', message);
        
        // æ˜¾ç¤ºäºŒç»´ç åŒºåŸŸ
        const qrSection = document.getElementById('qr-code-weather');
        if (qrSection) {
          qrSection.classList.remove('hidden');
        }
      });
      
      // å¤©æ°”æé†’å‘é€åˆ°å¾®ä¿¡ - ç§»é™¤é‡å¤ç»‘å®š
      // è¿™ä¸ªåŠŸèƒ½å·²ç»åœ¨åé¢å®šä¹‰ï¼Œé¿å…é‡å¤ç»‘å®š
      
      // è®¾ç½®é¡µé¢åˆ†äº«åˆ°å¾®ä¿¡
      document.getElementById('share-wechat')?.addEventListener('click', function() {
        const partnerName = document.getElementById('partner-name').value || 'äº²çˆ±çš„';
        const message = `æˆ‘æ­£åœ¨ä½¿ç”¨çˆ±çš„å¤©æ°”æé†’åº”ç”¨ï¼Œæ¯å¤©ä¸º${partnerName}é€ä¸Šæ¸©é¦¨çš„å…³æ€€ï¼ä¸€èµ·è®°å½•æˆ‘ä»¬çš„ç”œèœœæ—¶å…‰å§~ ğŸ’•`;
        
        shareToWeChat(message);
      });
      
      // ===== å¾®ä¿¡åˆ†äº«å¢å¼ºåŠŸèƒ½ =====
      
      // æ£€æµ‹å½“å‰ç¯å¢ƒæ˜¯å¦æ”¯æŒå„ç§åˆ†äº«æ–¹å¼
      function detectShareCapabilities() {
        return {
          webShare: !!navigator.share,
          clipboard: !!navigator.clipboard,
          qrCode: typeof QRCode !== 'undefined',
          wechat: typeof wx !== 'undefined' // å¾®ä¿¡JS-SDK
        };
      }
      
      // æ™ºèƒ½åˆ†äº«æ¨è
      function smartShare(message, options = {}) {
        const capabilities = detectShareCapabilities();
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        console.log('åˆ†äº«èƒ½åŠ›æ£€æµ‹:', capabilities);
        console.log('æ˜¯å¦ç§»åŠ¨ç«¯:', isMobile);
        
        // ç§»åŠ¨ç«¯ä¼˜å…ˆä½¿ç”¨Web Share API
        if (capabilities.webShare && isMobile) {
          return shareViaWebAPI(message);
        }
        
        // å¦‚æœæœ‰äºŒç»´ç åŠŸèƒ½ï¼Œæä¾›å¤šç§é€‰æ‹©
        if (capabilities.qrCode && options.showQR) {
          // æ˜¾ç¤ºåˆ†äº«é€‰é¡¹å¼¹çª—
          showShareOptions(message);
          return;
        }
        
        // é»˜è®¤ä½¿ç”¨å‰ªè´´æ¿
        shareViaClipboard(message);
      }
      
      // æ˜¾ç¤ºåˆ†äº«é€‰é¡¹å¼¹çª—
      function showShareOptions(message) {
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.innerHTML = `
          <div class="bg-white rounded-lg p-6 max-w-sm mx-4">
            <h3 class="text-lg font-bold mb-4 text-center">é€‰æ‹©åˆ†äº«æ–¹å¼</h3>
            <div class="space-y-3">
              <button id="copy-share" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">
                <i class="fa fa-copy mr-2"></i>å¤åˆ¶åˆ°å‰ªè´´æ¿
              </button>
              <button id="qr-share" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded">
                <i class="fa fa-qrcode mr-2"></i>ç”ŸæˆäºŒç»´ç 
              </button>
              ${navigator.share ? `
              <button id="native-share" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 px-4 rounded">
                <i class="fa fa-share-alt mr-2"></i>ç³»ç»Ÿåˆ†äº«
              </button>
              ` : ''}
              <button id="cancel-share" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded">
                å–æ¶ˆ
              </button>
            </div>
          </div>
        `;
        
        document.body.appendChild(modal);
        
        // ç»‘å®šäº‹ä»¶
        modal.querySelector('#copy-share').onclick = () => {
          shareViaClipboard(message);
          document.body.removeChild(modal);
        };
        
        modal.querySelector('#qr-share') && (modal.querySelector('#qr-share').onclick = () => {
          // åˆ›å»ºä¸´æ—¶äºŒç»´ç å®¹å™¨
          const qrContainer = document.createElement('div');
          qrContainer.id = 'temp-qr';
          qrContainer.className = 'mt-4 text-center';
          modal.querySelector('.bg-white').appendChild(qrContainer);
          
          generateQRCode('temp-qr', message);
          modal.querySelector('#qr-share').style.display = 'none';
        });
        
        modal.querySelector('#native-share') && (modal.querySelector('#native-share').onclick = () => {
          shareViaWebAPI(message);
          document.body.removeChild(modal);
        });
        
        modal.querySelector('#cancel-share').onclick = () => {
          document.body.removeChild(modal);
        };
        
        // ç‚¹å‡»èƒŒæ™¯å…³é—­
        modal.onclick = (e) => {
          if (e.target === modal) {
            document.body.removeChild(modal);
          }
        };
      }
      
      // å¢å¼ºå¤©æ°”åˆ†äº«æŒ‰é’®
      document.getElementById('send-wechat-weather')?.addEventListener('click', function() {
        const city = document.getElementById('city').value || 'åŒ—äº¬';
        const partnerName = document.getElementById('partner-name').value || 'äº²çˆ±çš„';
        const weatherInfo = `${city}ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦é€‚å®œï¼Œæ˜¯ä¸ªçº¦ä¼šçš„å¥½æ—¥å­å“¦~`;
        const message = `äº²çˆ±çš„${partnerName}ï¼Œ${weatherInfo} è®°å¾—æ³¨æ„ä¿æš–ï¼Œä¿æŒå¥½å¿ƒæƒ…ï¼â¤ï¸`;
        
        // ä½¿ç”¨æ™ºèƒ½åˆ†äº«
        smartShare(message, { showQR: true });
      });
      
      // æƒ…æ„ŸæŒ‡æ•°å›¾è¡¨
      const emotionChart = document.getElementById('emotionChart');
      if (emotionChart) {
        const ctx = emotionChart.getContext('2d');
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
            datasets: [{
              label: 'ç”œèœœæŒ‡æ•°',
              data: [75, 82, 78, 85, 90, 88, 85],
              borderColor: '#ff6b8b',
              backgroundColor: 'rgba(255, 107, 139, 0.1)',
              tension: 0.4,
              fill: true
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                display: false
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                max: 100
              }
            }
          }
        });
      }
      
      // è®¾ç½®é¡µé¢åŠŸèƒ½
      document.getElementById('save-settings')?.addEventListener('click', function() {
        const partnerName = document.getElementById('partner-name').value;
        const partnerBirthday = document.getElementById('partner-birthday').value;
        const relationshipDate = document.getElementById('relationship-date').value;
        const partnerPhone = document.getElementById('partner-phone').value;
        const partnerEmail = document.getElementById('partner-email').value;
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        const settings = {
          partnerName,
          partnerBirthday,
          relationshipDate,
          partnerPhone,
          partnerEmail,
          weatherNotify: document.getElementById('weather-notify').checked,
          birthdayNotify: document.getElementById('birthday-notify').checked,
          anniversaryNotify: document.getElementById('anniversary-notify').checked,
          emotionTrack: document.getElementById('emotion-track').checked,
          morningTime: document.getElementById('morning-time').value,
          eveningTime: document.getElementById('evening-time').value
        };
        
        localStorage.setItem('loveSettings', JSON.stringify(settings));
        alert('è®¾ç½®å·²ä¿å­˜æˆåŠŸï¼');
      });
      
      document.getElementById('reset-settings')?.addEventListener('click', function() {
        if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿ')) {
          localStorage.removeItem('loveSettings');
          document.getElementById('partner-name').value = '';
          document.getElementById('partner-birthday').value = '';
          document.getElementById('relationship-date').value = '';
          document.getElementById('partner-phone').value = '';
          document.getElementById('partner-email').value = '';
          alert('è®¾ç½®å·²é‡ç½®ï¼');
        }
      });
      
      // å¤©æ°”æé†’ä¿å­˜è®¾ç½®å‡½æ•°
      function saveWeatherSettings() {
        try {
          const city = document.getElementById('city').value;
          const sendTime = document.getElementById('send-time').value;
          const contentCheckboxes = document.querySelectorAll('#weather input[type="checkbox"]:checked');
          const selectedContent = Array.from(contentCheckboxes).map(cb => cb.nextElementSibling.textContent);
          
          if (!city || !sendTime) {
            alert('è¯·å¡«å†™å®Œæ•´çš„åŸå¸‚åç§°å’Œå‘é€æ—¶é—´ï¼');
            return;
          }
          
          const weatherSettings = {
            city: city,
            sendTime: sendTime,
            selectedContent: selectedContent,
            timestamp: new Date().toISOString()
          };
          
          localStorage.setItem('weatherSettings', JSON.stringify(weatherSettings));
          alert('å¤©æ°”æé†’è®¾ç½®å·²ä¿å­˜æˆåŠŸï¼');
          
          // æ›´æ–°é¢„è§ˆ
          updateWeatherPreview();
        } catch (error) {
          console.error('ä¿å­˜å¤©æ°”è®¾ç½®å¤±è´¥:', error);
          alert('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•ï¼');
        }
      }
      
      // ç”Ÿæ—¥ç¥ç¦ä¿å­˜è®¾ç½®å‡½æ•°
      function saveBirthdaySettings() {
        try {
          const contactName = document.getElementById('contact-name').value;
          const birthdayDate = document.getElementById('birthday-date').value;
          const relation = document.getElementById('birthday-relation').value;
          const wechatId = document.getElementById('birthday-wechat').value;
          const remindDay = document.getElementById('remind-day').value;
          const remindTime = document.getElementById('remind-time').value;
          
          if (!contactName || !birthdayDate) {
            alert('è¯·å¡«å†™å®Œæ•´çš„è”ç³»äººå§“åå’Œç”Ÿæ—¥æ—¥æœŸï¼');
            return;
          }
          
          const birthdaySettings = {
            contactName: contactName,
            birthdayDate: birthdayDate,
            relation: relation,
            wechatId: wechatId,
            remindDay: remindDay,
            remindTime: remindTime,
            timestamp: new Date().toISOString()
          };
          
          localStorage.setItem('birthdaySettings', JSON.stringify(birthdaySettings));
          alert('ç”Ÿæ—¥ç¥ç¦è®¾ç½®å·²ä¿å­˜æˆåŠŸï¼');
          
          // æ›´æ–°é¢„è§ˆ
          updateBirthdayPreview();
        } catch (error) {
          console.error('ä¿å­˜ç”Ÿæ—¥è®¾ç½®å¤±è´¥:', error);
          alert('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•ï¼');
        }
      }
      
      // æ›´æ–°å¤©æ°”é¢„è§ˆ
      function updateWeatherPreview() {
        try {
          const savedSettings = localStorage.getItem('weatherSettings');
          if (savedSettings) {
            const settings = JSON.parse(savedSettings);
            // è¿™é‡Œå¯ä»¥æ›´æ–°é¢„è§ˆåŒºåŸŸçš„æ˜¾ç¤ºå†…å®¹
            console.log('å¤©æ°”é¢„è§ˆå·²æ›´æ–°:', settings);
          }
        } catch (error) {
          console.error('æ›´æ–°å¤©æ°”é¢„è§ˆå¤±è´¥:', error);
        }
      }
      
      // æ›´æ–°ç”Ÿæ—¥é¢„è§ˆ
      function updateBirthdayPreview() {
        try {
          const savedSettings = localStorage.getItem('birthdaySettings');
          if (savedSettings) {
            const settings = JSON.parse(savedSettings);
            // è¿™é‡Œå¯ä»¥æ›´æ–°é¢„è§ˆåŒºåŸŸçš„æ˜¾ç¤ºå†…å®¹
            console.log('ç”Ÿæ—¥é¢„è§ˆå·²æ›´æ–°:', settings);
          }
        } catch (error) {
          console.error('æ›´æ–°ç”Ÿæ—¥é¢„è§ˆå¤±è´¥:', error);
        }
      }
      
      // åŠ è½½ä¿å­˜çš„è®¾ç½®
      const savedSettings = localStorage.getItem('loveSettings');
      if (savedSettings) {
        const settings = JSON.parse(savedSettings);
        document.getElementById('partner-name').value = settings.partnerName || '';
        document.getElementById('partner-birthday').value = settings.partnerBirthday || '';
        document.getElementById('relationship-date').value = settings.relationshipDate || '';
        document.getElementById('partner-phone').value = settings.partnerPhone || '';
        document.getElementById('partner-email').value = settings.partnerEmail || '';
        document.getElementById('weather-notify').checked = settings.weatherNotify !== false;
        document.getElementById('birthday-notify').checked = settings.birthdayNotify !== false;
        document.getElementById('anniversary-notify').checked = settings.anniversaryNotify !== false;
        document.getElementById('emotion-track').checked = settings.emotionTrack !== false;
        document.getElementById('morning-time').value = settings.morningTime || '07:30';
        document.getElementById('evening-time').value = settings.eveningTime || '21:30';
      }
    });
  </script>
  
  <!-- è®¿é—®ç»Ÿè®¡åŠŸèƒ½ -->
  <script>
    // VisitTracker ç±»å®šä¹‰
    class VisitTracker {
      constructor() {
        this.visits = this.loadVisits();
        this.recordVisit();
      }
      
      loadVisits() {
        try {
          const saved = localStorage.getItem('visitStats');
          return saved ? JSON.parse(saved) : {
            totalVisits: 0,
            visits: [],
            uniqueVisitors: new Set()
          };
        } catch (error) {
          console.error('åŠ è½½è®¿é—®æ•°æ®å¤±è´¥:', error);
          return { totalVisits: 0, visits: [], uniqueVisitors: new Set() };
        }
      }
      
      recordVisit() {
        try {
          const now = new Date();
          const visitData = {
            timestamp: now.getTime(),
            date: now.toLocaleDateString(),
            time: now.toLocaleTimeString(),
            userAgent: navigator.userAgent.substring(0, 100)
          };
          
          this.visits.totalVisits++;
          this.visits.visits.push(visitData);
          
          // ä¿æŒæœ€è¿‘100æ¡è®°å½•
          if (this.visits.visits.length > 100) {
            this.visits.visits = this.visits.visits.slice(-100);
          }
          
          this.saveVisits();
          this.showVisitNotification();
        } catch (error) {
          console.error('è®°å½•è®¿é—®å¤±è´¥:', error);
        }
      }
      
      saveVisits() {
        try {
          localStorage.setItem('visitStats', JSON.stringify(this.visits));
        } catch (error) {
          console.error('ä¿å­˜è®¿é—®æ•°æ®å¤±è´¥:', error);
        }
      }
      
      getTodayVisits() {
        const today = new Date().toLocaleDateString();
        return this.visits.visits.filter(v => v.date === today).length;
      }
      
      getUniqueVisitors() {
        return new Set(this.visits.visits.map(v => v.userAgent)).size;
      }
      
      getRecentVisits(days = 7) {
        const cutoff = new Date();
        cutoff.setDate(cutoff.getDate() - days);
        return this.visits.visits.filter(v => new Date(v.timestamp) > cutoff);
      }
      
      clearAll() {
        if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è®¿é—®æ•°æ®å—ï¼Ÿ')) {
          this.visits = { totalVisits: 0, visits: [], uniqueVisitors: new Set() };
          this.saveVisits();
          return true;
        }
        return false;
      }
      
      exportData() {
        return JSON.stringify(this.visits, null, 2);
      }
      
      showVisitNotification() {
        try {
          const todayVisits = this.getTodayVisits();
          if (todayVisits === 1) {
            this.showNotification('ğŸ‰ æ¬¢è¿é¦–æ¬¡è®¿é—®ï¼', 'æ„Ÿè°¢ä½¿ç”¨çˆ±çš„å¤©æ°”æé†’åº”ç”¨');
          } else {
            this.showNotification(`ğŸŒŸ æ¬¢è¿å›æ¥ï¼`, 'ä»Šå¤©æ˜¯æ‚¨ç¬¬' + todayVisits + 'æ¬¡è®¿é—®');
          }
        } catch (error) {
          console.error('æ˜¾ç¤ºè®¿é—®é€šçŸ¥å¤±è´¥:', error);
        }
      }
      
      showNotification(title, message) {
        // åˆ›å»ºé€šçŸ¥å…ƒç´ 
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-primary text-white px-4 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
        notification.innerHTML = `
          <div class="font-bold">${title}</div>
          <div class="text-sm">${message}</div>
        `;
        
        document.body.appendChild(notification);
        
        // æ˜¾ç¤ºåŠ¨ç”»
        setTimeout(() => {
          notification.classList.remove('translate-x-full');
        }, 100);
        
        // è‡ªåŠ¨éšè—
        setTimeout(() => {
          notification.classList.add('translate-x-full');
          setTimeout(() => {
            if (document.body.contains(notification)) {
              document.body.removeChild(notification);
            }
          }, 300);
        }, 3000);
      }
    }
    
    // æ˜¾ç¤ºè®¿é—®ç»Ÿè®¡
    function showVisitStats() {
      try {
        if (!window.visitTracker) {
          alert('è®¿é—®ç»Ÿè®¡åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
          return;
        }
        
        const modal = document.getElementById('visit-stats-modal');
        if (!modal) {
          console.error('è®¿é—®ç»Ÿè®¡å¼¹çª—å…ƒç´ æœªæ‰¾åˆ°');
          return;
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        document.getElementById('total-visits').textContent = window.visitTracker.visits.totalVisits;
        document.getElementById('today-visits').textContent = window.visitTracker.getTodayVisits();
        document.getElementById('unique-visitors').textContent = window.visitTracker.getUniqueVisitors();
        
        // æ›´æ–°æœ€è¿‘è®¿é—®
        const recentVisits = window.visitTracker.getRecentVisits(7);
        const recentContainer = document.getElementById('recent-visits');
        
        if (recentVisits.length > 0) {
          recentContainer.innerHTML = recentVisits.slice(-5).reverse().map(visit => `
            <div class="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0">
              <span class="text-sm">${visit.date} ${visit.time}</span>
              <span class="text-xs text-gray-500">${visit.userAgent.substring(0, 30)}...</span>
            </div>
          `).join('');
        } else {
          recentContainer.innerHTML = '<p class="text-gray-500 text-center py-4">æš‚æ— æœ€è¿‘è®¿é—®è®°å½•</p>';
        }
        
        // æ˜¾ç¤ºå¼¹çª—
        modal.classList.remove('hidden');
      } catch (error) {
        console.error('æ˜¾ç¤ºè®¿é—®ç»Ÿè®¡å¤±è´¥:', error);
        alert('æ˜¾ç¤ºè®¿é—®ç»Ÿè®¡å¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°äº†è§£è¯¦æƒ…');
      }
    }
    
    // åˆå§‹åŒ–è®¿é—®ç»Ÿè®¡
    try {
      window.visitTracker = new VisitTracker();
      window.pageInitialized = true;
      console.log('é¡µé¢åˆå§‹åŒ–å®Œæˆ');
    } catch (error) {
      console.error('è®¿é—®ç»Ÿè®¡åˆå§‹åŒ–å¤±è´¥:', error);
      window.pageInitialized = false;
    }
    
    // å…¨å±€é”™è¯¯å¤„ç†
    window.addEventListener('error', function(event) {
      console.error('å…¨å±€é”™è¯¯æ•è·:', event.error);
      console.error('é”™è¯¯ä¿¡æ¯:', event.message);
      console.error('é”™è¯¯æ–‡ä»¶:', event.filename);
      console.error('é”™è¯¯è¡Œå·:', event.lineno);
      console.error('é”™è¯¯åˆ—å·:', event.colno);
    });
    
    window.addEventListener('unhandledrejection', function(event) {
      console.error('æœªå¤„ç†çš„Promiseæ‹’ç»:', event.reason);
    });
  </script>
  
  <!-- è®¿é—®ç»Ÿè®¡å¼¹çª— -->
  <div id="visit-stats-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-96 overflow-hidden">
      <div class="bg-gradient-to-r from-pink-500 to-purple-500 text-white p-6">
        <div class="flex justify-between items-center">
          <h3 class="text-xl font-bold">è®¿é—®ç»Ÿè®¡</h3>
          <button onclick="document.getElementById('visit-stats-modal').classList.add('hidden')" class="text-white hover:text-gray-200">
            <i class="fa fa-times text-xl"></i>
          </button>
        </div>
      </div>
      <div class="p-6">
        <div class="grid grid-cols-3 gap-4 mb-6">
          <div class="text-center">
            <div class="text-2xl font-bold text-primary" id="total-visits">0</div>
            <div class="text-sm text-gray-600">æ€»è®¿é—®é‡</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-secondary" id="today-visits">0</div>
            <div class="text-sm text-gray-600">ä»Šæ—¥è®¿é—®</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-tertiary" id="unique-visitors">0</div>
            <div class="text-sm text-gray-600">ç‹¬ç«‹è®¿å®¢</div>
          </div>
        </div>
        <div class="mb-4">
          <h4 class="font-bold mb-2">æœ€è¿‘è®¿é—®</h4>
          <div id="recent-visits" class="text-sm text-gray-600 max-h-32 overflow-y-auto">
            <p>æš‚æ— è®¿é—®è®°å½•</p>
          </div>
        </div>
        <div class="flex space-x-4">
          <button id="export-visits" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg text-sm transition-colors-300">
            <i class="fa fa-download mr-1"></i> å¯¼å‡ºæ•°æ®
          </button>
          <button id="clear-visits" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg text-sm transition-colors-300">
            <i class="fa fa-trash mr-1"></i> æ¸…ç©ºæ•°æ®
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ç§»åŠ¨èœå•åŠŸèƒ½ -->
  <script>
    // ç§»åŠ¨èœå•åŠŸèƒ½
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      
      if (mobileMenuButton && mobileMenu) {
        mobileMenuButton.addEventListener('click', function() {
          mobileMenu.classList.toggle('hidden');
        });
        
        // ç§»åŠ¨ç«¯å¯¼èˆªé“¾æ¥ç‚¹å‡»åå…³é—­èœå•
        const mobileNavLinks = mobileMenu.querySelectorAll('.nav-link');
        mobileNavLinks.forEach(link => {
          link.addEventListener('click', function() {
            mobileMenu.classList.add('hidden');
          });
        });
      }
      
      // è®¿é—®ç»Ÿè®¡æŒ‰é’®äº‹ä»¶
      const viewVisitsBtn = document.getElementById('view-visits');
      const viewVisitsMobileBtn = document.getElementById('view-visits-mobile');
      
      if (viewVisitsBtn) {
        viewVisitsBtn.addEventListener('click', function(e) {
          e.preventDefault();
          if (window.showVisitStats) {
            showVisitStats();
          } else {
            alert('è®¿é—®ç»Ÿè®¡åŠŸèƒ½æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨åå†è¯•');
          }
        });
      }
      
      if (viewVisitsMobileBtn) {
        viewVisitsMobileBtn.addEventListener('click', function(e) {
          e.preventDefault();
          if (window.showVisitStats) {
            showVisitStats();
          } else {
            alert('è®¿é—®ç»Ÿè®¡åŠŸèƒ½æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨åå†è¯•');
          }
        });
      }
      
      // è®¿é—®ç»Ÿè®¡å¼¹çª—æŒ‰é’®äº‹ä»¶
      const exportBtn = document.getElementById('export-visits');
      const clearBtn = document.getElementById('clear-visits');
      
      if (exportBtn) {
        exportBtn.addEventListener('click', function() {
          try {
            if (window.visitTracker) {
              const data = window.visitTracker.exportData();
              const blob = new Blob([data], { type: 'application/json' });
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = `visit-stats-${new Date().toISOString().split('T')[0]}.json`;
              a.click();
              URL.revokeObjectURL(url);
            }
          } catch (error) {
            console.error('å¯¼å‡ºè®¿é—®æ•°æ®å¤±è´¥:', error);
            alert('å¯¼å‡ºå¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°äº†è§£è¯¦æƒ…');
          }
        });
      }
      
      if (clearBtn) {
        clearBtn.addEventListener('click', function() {
          try {
            if (window.visitTracker && window.visitTracker.clearAll()) {
              // æ›´æ–°æ˜¾ç¤º
              showVisitStats();
            }
          } catch (error) {
            console.error('æ¸…ç©ºè®¿é—®æ•°æ®å¤±è´¥:', error);
            alert('æ¸…ç©ºå¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°äº†è§£è¯¦æƒ…');
          }
        });
      }
    });
  </script>
</body>
</html>
